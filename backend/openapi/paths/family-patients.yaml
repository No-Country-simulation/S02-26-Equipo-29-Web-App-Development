familyPatientsByPatient:
  get:
    tags: [FamilyPatients]
    operationId: listFamilyPatientsByPatient
    summary: Listar vínculos FAMILY_PATIENTS de un paciente
    parameters:
      - $ref: "../components/parameters.yaml#/PatientId"
    responses:
      "200":
        description: OK
        content:
          application/json:
            schema:
              type: array
              items: { $ref: "../schemas/family-patients.yaml#/FamilyPatient" }
      "404":
        $ref: "../components/responses.yaml#/NotFound"

  post:
    tags: [FamilyPatients]
    operationId: createFamilyPatientLink
    summary: Crear vínculo FAMILY_PATIENTS para un paciente
    description: >
      Crea el vínculo entre un paciente y una familia (profile con role=family).
      Regla típica: no permitir duplicados (family_id + patient_id).
    parameters:
      - $ref: "../components/parameters.yaml#/PatientId"
    requestBody:
      required: true
      content:
        application/json:
          schema: { $ref: "../schemas/family-patients.yaml#/FamilyPatientCreateRequest" }
    responses:
      "201":
        description: Creado
        content:
          application/json:
            schema: { $ref: "../schemas/family-patients.yaml#/FamilyPatient" }
      "404":
        $ref: "../components/responses.yaml#/NotFound"
      "409":
        $ref: "../components/responses.yaml#/Conflict"
      "422":
        $ref: "../components/responses.yaml#/UnprocessableEntity"

familyPatientById:
  patch:
    tags: [FamilyPatients]
    operationId: updateFamilyPatientLink
    summary: Actualizar vínculo FAMILY_PATIENTS
    description: >
      Permite cambiar el campo relationship.
    parameters:
      - $ref: "../components/parameters.yaml#/FamilyPatientId"
    requestBody:
      required: true
      content:
        application/json:
          schema: { $ref: "../schemas/family-patients.yaml#/FamilyPatientUpdateRequest" }
    responses:
      "200":
        description: Actualizado
        content:
          application/json:
            schema: { $ref: "../schemas/family-patients.yaml#/FamilyPatient" }
      "404":
        $ref: "../components/responses.yaml#/NotFound"
      "422":
        $ref: "../components/responses.yaml#/UnprocessableEntity"

  delete:
    tags: [FamilyPatients]
    operationId: deleteFamilyPatientLink
    summary: Eliminar vínculo FAMILY_PATIENTS
    parameters:
      - $ref: "../components/parameters.yaml#/FamilyPatientId"
    responses:
      "204":
        $ref: "../components/responses.yaml#/NoContent"
      "404":
        $ref: "../components/responses.yaml#/NotFound"
